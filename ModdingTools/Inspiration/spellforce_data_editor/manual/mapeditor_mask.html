<!DOCTYPE html>
<html lang="en-US">
<head>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<h1>Map Editor - Mask/selection mode</h1>
<p>To aid in precise editing of terrain features, Map Editor comes with mask layer editor. Terrain heights, lakes, flags, textures and decorations can't be affected if the terrain that's being modified is masked.</p>
<p>To modify mask, select selection source, selection filter and mask operation, and then press <i>Apply to mask</i> button.</p>
<p>You can also quickly clear mask with <i>Clear mask</i> button, and invert it using <i>Invert mask</i> button.</p>
<warning>Undo/redo does not work on mask or selection.</warning>
<img src="img/mapeditmask.png">

<h2>Selection source</h2>
<p>Selection source controls which parts of terrain are selected. Currently available sources are:</p>
<ul>
  <li><b>All</b> - all terrain becomes selected.</li>
  <li><b>Paint</b> - you can manually select parts of terrain if this selection source is enabled. Brush settings apply to this mode.</li>
  <li><b>Mask</b> - terrain under current mask becomes selected.</li>
  <li><b>Terrain texture</b> - terrain with specified texture ID is selected. You can use <b>right mouse button</b> to pick terrain texture from the terrain.</li>
  <li><b>Terrain height</b> - terrain at specified height is selected. You can use <b>right mouse button</b> to pick terrain height from the terrain. <b>Comparison mode</b> specifies which parts of the terrain become selected:
  <ul>
    <li><b>Equal</b> - only terrain of exactly specified height is selected</li>
	<li><b>Greater or equal</b> - terrain is selected if its height is greater or equal than the specified height</li>
	<li><b>Greater than</b> - terrain is selected if its height is greater than the specified height</li>
	<li><b>Not equal</b> - terrain is selected if its height is not equal to the specified height</li>
	<li><b>Less than</b> - terrain is selected if its height is less than the specified height</li>
	<li><b>Less or equal</b> - terrain is selected if its height is less or equal than the specified height</li>
  </ul></li>
  <li><b>Terrain slope</b> - terrain with specified slope is selected. You can use <b>right mouse button</b> to pick terrain slope from the terrain. <b>Comparison mode</b> applies in this mode.</li>
  <li><b>Terrain attribute</b> - terrain is selected based on specified attribute. Currently available attributes are:
  <ul>
    <li><b>Terrain block</b> - all terrain with a texture that blocks movement is selected.</li>
	<li><b>Object block</b> - all terrain of which movement is blocked by an object is selected.</li>
	<li><b>Building block</b> - all terrain of which movement is blocked by a building is selected.</li>
	<li><b>Manual block</b> - all terrain of which movement is blocked by manually placed movement flag is selected.</li>
	<li><b>Lake</b> - all terrain that is under water is selected. <b>Depth</b> and <b>comparison mode</b> for depth further specify the selection. You can use <b>right mouse button</b> to pick depth from the terrain under water. <warning>Ocean is not treated as water for the purpose of this attribute.</warning></li>
	<li><b>Shore</b> - all terrain that surrounds water is selected. <warning>Ocean is not treated as water for the purpose of this attribute.</warning></li>
  </ul></li>
  <li><b>Feature</b> - terrain is selected based on selected feature. Use <b>left mouse button</b> to pick a feature from the map, and <b>right mouse button</b> to deselect it. Currently available features are:
  <ul>
    <li><b>Building</b> - terrain blocked by selected building is selected.</li>
	<li><b>Object</b> - terrain blocked by selected object is selected. You can use any object, including monuments, portals and bindstones.</li>
	<li><b>Lake</b> - terrain under selected lake is selected. <b>Depth</b> and <b>comparison mode</b> for depth further specify the selection. You can use <b>right mouse button</b> to pick depth from the terrain under water.</li>
	<li><b>Walkable</b> - upon picking terrain, all terrain that can be walked from selected position unobstructed by movement block will be selected.</li>
  </ul></li>
</ul>

<h2>Selection filter</h2>
<p>After selecting a source, you can further modify selection using a filter. Currently available filters are:</p>
<ul>
  <li><b>None</b> - no filter is applied to the selection.</li>
  <li><b>Border</b> - only the border of selection passes this filter. <i>Outer</i> border selects terrain outside of the current selection, <i>Inner</i> border selects terrain that's the closest to outside of the current selection.</li>
  <li><b>Random</b> - current selection is passed through random check filter and only the terrain that passes the check remains selected. <i>Percentage</i> specifies the relative amount of cells that survive the check. This check is consistent - for example, cells that pass the 25% random check will always pass the 50% random check. <i>Randomize</i> button randomizes which cells pass the check.</li>
</ul>

<h2>Mask operation</h2>
<p>Mask operation modifies the mask based on current selection and the type of selected operation. Currently available operations are:</p>
<ul>
  <li><b>Do nothing</b> - nothing happens.</li>
  <li><b>Set mask</b> - current mask is cleared and replaced with current selection.</li>
  <li><b>Intersect with mask</b> - only terrain that is both under the mask and selected stays under the mask.</li>
  <li><b>Join with mask</b> - current selection is added to current mask.</li>
  <li><b>Either-or with mask</b> - if terrain is under current mask and not selected, it stays under mask; if terrain is selected and not under mask, it is added to current mask; all other terrain is removed from the current mask.</li>
  <li><b>Exclude from mask</b> - current selection is removed from current mask.</li>
</ul>
<img src="img/mapeditmaskoperation.png">

<h2>Example usage</h2>
<h3>Paint terrain around the road</h3>
<ol>
  <li>Paint rough outline using <b>Paint</b> source, no filter and </b>Set mask</b> operation</li>
  <li>Select road using <b>Terrain texture</b> source and road texture ID, no filter and <b>Intersect with mask</b> operation</li>
  <li>Select terrain around road using <b>Mask</b> source, <b>Border</b> filter (outer border) and <b>Set mask</b> operation</li>
  <li>Click <i>Invert mask</i></li>
  <li>Paint over selected terrain in <i>Textures</i> editor mode (Shift + LMB with selected tile)</li>
</ol>
<img src="img/mapeditmaskex1.png">